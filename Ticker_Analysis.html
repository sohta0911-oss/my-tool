<div class="container">
    <h2>Ticker Analysis</h2>
    <p class="description">銘柄コードを入力してサイトを選択</p>
    <div class="input-wrapper">
        <input type="text" id="ticker" placeholder="例: NVDA / 7203" autocomplete="off">
    </div>
    
    <div style="display: flex; flex-direction: column; gap: 10px;">
        <button onclick="execute('tv')" style="background-color: #2962ff;">TradingViewを開く</button>
        <button onclick="execute('summary')" style="background-color: #ff9800;">Summaryを開く</button>
        <button onclick="execute('finance')" style="background-color: #4caf50;">Financeを開く</button>
    </div>

    <div class="status-labels">
        <span>TradingView</span>
        <span>Finviz / Nikkei</span>
        <span>Yahoo Finance</span>
    </div>
</div>

<script>
    function execute(type) {
        const input = document.getElementById('ticker').value.trim();
        if (!input) return;

        const isJapan = /^\d{4}$/.test(input) || /^\d{3}[A-Z]$/i.test(input);
        let url = "";

        if (isJapan) {
            const code = input.toUpperCase();
            // 日本株の条件分岐
            if (type === 'tv') url = `https://jp.tradingview.com/chart/?symbol=TSE:${code}`;
            if (type === 'summary') url = `https://www.nikkei.com/nkd/company/?scode=${code}`;
            if (type === 'finance') url = `https://finance.yahoo.co.jp/quote/${code}.T`;
        } else {
            const ticker = input.toUpperCase();
            // 米国株の条件分岐
            if (type === 'tv') url = `https://jp.tradingview.com/chart/?symbol=${ticker}`;
            if (type === 'summary') url = `https://finviz.com/quote.ashx?t=${ticker}`;
            if (type === 'finance') url = `https://finance.yahoo.co.jp/quote/${ticker}`;
        }

        // 1つのクリックに対して、1つの窓だけを開く（Safari公認の挙動）
        if (url) window.open(url, '_blank');
    }
</script>
